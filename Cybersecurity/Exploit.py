import tkinter as tk
from tkinter import messagebox
import xmlrpc.client

class MetaExploitGUI:
    def __init__(self, root):
        self.root = root
        self.root.title("MetaExploit GUI")
        
        self.create_widgets()
        
        self.rpc_client = None
        
    def create_widgets(self):
        tk.Label(self.root, text="MSF Host:").grid(row=0, column=0)
        self.host_entry = tk.Entry(self.root)
        self.host_entry.grid(row=0, column=1)
        self.host_entry.insert(0, "http://127.0.0.1:55552")
        
        tk.Label(self.root, text="MSF Password:").grid(row=1, column=0)
        self.pass_entry = tk.Entry(self.root, show="*")
        self.pass_entry.grid(row=1, column=1)
        
        tk.Button(self.root, text="Connect", command=self.connect_to_msf).grid(row=2, column=0, columnspan=2)
        
        self.status_label = tk.Label(self.root, text="Status: Not Connected", fg="red")
        self.status_label.grid(row=3, column=0, columnspan=2)
    
    def connect_to_msf(self):
        host = self.host_entry.get()
        password = self.pass_entry.get()
        
        try:
            self.rpc_client = xmlrpc.client.ServerProxy(f"{host}/api")
            auth_token = self.rpc_client.auth.login("msf", password)
            
            if auth_token.get("result") == "success":
                self.token = auth_token.get("token")
                self.status_label.config(text="Status: Connected", fg="green")
                messagebox.showinfo("Success", "Connected to MSF RPC Server!")
            else:
                messagebox.showerror("Error", "Authentication failed!")
        except Exception as e:
            messagebox.showerror("Error", f"Connection failed: {str(e)}")

if __name__ == "__main__":
    root = tk.Tk()
    app = MetaExploitGUI(root)
    root.mainloop()
